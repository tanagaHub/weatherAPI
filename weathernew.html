<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h2>Weather API</h2>
    <form id="form">

        <input type="text" id="city">
        <input id="btn" type="submit" value="search">
    </form>

    <div id="div">
        <p id="para"></p>
        
    </div>

    <script type="text/javascript">
    const ip = ''; // Current IP
        fetch(`https://ipapi.co/${ip}/json/`)
.then(function(response) {
  response.json().then(jsonData => {
    console.log(jsonData);
    console.log(ip)
  });
})
.catch(function(error) {
  console.log(error)
});
    let form = document.getElementById('form')
        let div = document.getElementById('div')
        let input = document.getElementById('city')
       // let btn = document.getElementById('btn')
        let img = document.createElement('img')

        form.addEventListener('submit', (ev) => {
            console.log(ev);
            ev.preventDefault()

            fetch(`https://api.weatherbit.io/v2.0/current?city=${input.value}&country=%D0%B1%D1%8A%D0%BB%D0%B3%D0%B0%D1%80%D0%B8%D1%8F&lang=bg&key=db9d0e59b2024496af26d5b280f68ebe`)
                .then(response => response.json())
                .then(response => {
                    let obj = response['data'][0]
                    let icon = obj.weather.icon
                    img.setAttribute('src', `https://www.weatherbit.io/static/img/icons/${icon}.png`)
                    let p = document.getElementById('para')
                    p.innerHTML = `${obj.city_name} : ${obj.temp} &#x2103;` 
                    div.appendChild(img)
                    console.log(obj.weather.icon);
                    console.log(obj);
                    



                })
                .catch(err => console.error(err));

        })
        
    </script>
</body>

</html>